(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{289:(r,t,e)=>{Promise.resolve().then(e.bind(e,2131))},2131:(r,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>c});var a=e(2860),o=e(3200),s=e(9726),n=e(6937);function c(){let[r,t]=(0,o.useState)(""),[e,c]=(0,o.useState)(""),{login:i,isLoading:l,error:d,clearError:u}=(0,s.A)();(0,n.useRouter)();let h=async t=>{t.preventDefault(),u();try{await i({username:r,password:e})}catch(r){console.error("Login page caught error:",r)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,a.jsx)("img",{className:"mx-auto h-12 w-auto",src:"/logo-placeholder.svg",alt:"CTaaS Platform"})," ",(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Sign in to your account"})]}),(0,a.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,a.jsxs)("form",{className:"space-y-6",onSubmit:h,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Username or Email"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,value:r,onChange:r=>t(r.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:e,onChange:r=>c(r.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white"})})]}),d&&(0,a.jsx)("div",{className:"rounded-md bg-red-50 dark:bg-red-900 p-4",children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:d})})})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center"}),(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("a",{href:"#",className:"font-medium text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300",children:"Forgot your password? (Placeholder)"})})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 dark:focus:ring-offset-gray-800",children:l?"Signing in...":"Sign in"})})]})})})]})}},9726:(r,t,e)=>{"use strict";e.d(t,{A:()=>d,AuthProvider:()=>l});var a=e(2860),o=e(3200),s=e(6937),n=e(3345),c=e(3875);let i=(0,o.createContext)(void 0),l=r=>{let{children:t}=r,[e,l]=(0,o.useState)(!1),[d,u]=(0,o.useState)(null),[h,g]=(0,o.useState)(!0),[m,f]=(0,o.useState)(null),y=(0,s.useRouter)();(0,o.useEffect)(()=>{let r=localStorage.getItem("authToken");r?((0,n.O5)(r),x()):g(!1)},[]);let x=async()=>{g(!0);try{let r=await (0,n.VM)();u(r.user||r),l(!0),f(null)}catch(r){console.error("Failed to fetch user profile:",r),localStorage.removeItem("authToken"),(0,n.O5)(null),l(!1),u(null)}finally{g(!1)}},p=async r=>{g(!0),f(null);try{let t=await (0,n.Lx)(r);if(t.access_token)localStorage.setItem("authToken",t.access_token),await x(),y.push("/");else throw Error("Login failed: No token received.")}catch(a){var t,e;console.error("Login error:",a);let r="Login failed. Please check your credentials.";throw c.A.isAxiosError(a)&&(null===(e=a.response)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)?r=a.response.data.message:a instanceof Error&&"Login failed: No token received."!==a.message&&(r=a.message),f(r),l(!1),u(null),localStorage.removeItem("authToken"),(0,n.O5)(null),g(!1),a}},w=async()=>{g(!0);try{await (0,n.y4)()}catch(r){console.error("Logout API call failed (if any):",r)}finally{localStorage.removeItem("authToken"),l(!1),u(null),f(null),g(!1),y.push("/login")}};return(0,a.jsx)(i.Provider,{value:{isAuthenticated:e,user:d,login:p,logout:w,isLoading:h,error:m,clearError:()=>{f(null)}},children:t})},d=()=>{let r=(0,o.useContext)(i);if(void 0===r)throw Error("useAuth must be used within an AuthProvider");return r}},3345:(r,t,e)=>{"use strict";e.d(t,{Aq:()=>w,I3:()=>y,IR:()=>f,I_:()=>c,Jf:()=>l,Kk:()=>p,Lx:()=>N,O5:()=>n,TK:()=>E,VM:()=>_,YJ:()=>m,fm:()=>b,gu:()=>g,iS:()=>v,jD:()=>d,lo:()=>j,mc:()=>u,nT:()=>i,pV:()=>h,rx:()=>x,sH:()=>k,y4:()=>S});var a=e(3875);let o=e(4916).env.NEXT_PUBLIC_API_URL||"/api/v1",s=a.A.create({baseURL:o,headers:{"Content-Type":"application/json"}}),n=r=>{r?s.defaults.headers.common.Authorization="Bearer ".concat(r):delete s.defaults.headers.common.Authorization},c=async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await s.get("/trials",{params:r})).data}catch(r){throw console.error("Error fetching trials:",r),r}},i=async r=>{try{return(await s.get("/trials/".concat(r))).data}catch(t){throw console.error("Error fetching trial ".concat(r,":"),t),t}},l=async r=>{try{return(await s.post("/trials",r)).data}catch(r){throw console.error("Error creating trial:",r),r}},d=async r=>{try{return(await s.get("/trials/".concat(r,"/protocols"))).data}catch(t){throw console.error("Error fetching protocols for trial ".concat(r,":"),t),t}},u=async(r,t)=>{try{return(await s.post("/trials/".concat(r,"/protocols/draft"),t)).data}catch(t){throw console.error("Error drafting protocol for trial ".concat(r,":"),t),t}},h=async r=>{try{return(await s.get("/protocols/generation-status/".concat(r))).data}catch(t){throw console.error("Error fetching protocol generation status for task ".concat(r,":"),t),t}},g=async r=>{try{return(await s.get("/trials/".concat(r,"/irb-submissions"))).data}catch(t){throw console.error("Error fetching IRB submissions for trial ".concat(r,":"),t),t}},m=async(r,t)=>{try{return(await s.post("/trials/".concat(r,"/irb-submissions"),t)).data}catch(t){throw console.error("Error creating IRB submission for trial ".concat(r,":"),t),t}},f=async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await s.get("/sites",{params:r})).data}catch(r){throw console.error("Error fetching global sites:",r),r}},y=async r=>{try{return(await s.get("/trials/".concat(r,"/sites"))).data}catch(t){throw console.error("Error fetching sites for trial ".concat(r,":"),t),t}},x=async(r,t)=>{try{return(await s.post("/trials/".concat(r,"/sites"),t)).data}catch(t){throw console.error("Error associating site to trial ".concat(r,":"),t),t}},p=async r=>{try{return(await s.get("/trials/".concat(r,"/patients"))).data}catch(t){throw console.error("Error fetching patients for trial ".concat(r,":"),t),t}},w=async(r,t)=>{try{return(await s.post("/trials/".concat(r,"/patients/identify"),t)).data}catch(t){throw console.error("Error identifying patients for trial ".concat(r,":"),t),t}},v=async r=>{try{return(await s.get("/patients/identification-status/".concat(r))).data}catch(t){throw console.error("Error fetching patient identification status for task ".concat(r,":"),t),t}},b=async r=>{try{return(await s.get("/trials/".concat(r,"/monitoring/summary"))).data}catch(t){throw console.error("Error fetching monitoring summary for trial ".concat(r,":"),t),t}},k=async r=>{try{return(await s.get("/trials/".concat(r,"/monitoring/events"))).data}catch(t){throw console.error("Error fetching monitoring events for trial ".concat(r,":"),t),t}},j=async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await s.get("/admin/users",{params:r})).data}catch(r){throw console.error("Error fetching users:",r),r}},E=async(r,t)=>{try{return(await s.put("/admin/users/".concat(r),t)).data}catch(t){throw console.error("Error updating user ".concat(r,":"),t),t}},N=async r=>{try{let t=await s.post("/auth/login",r);return t.data.access_token&&n(t.data.access_token),t.data}catch(r){throw console.error("Error logging in:",r),n(null),r}},S=async()=>{n(null)},_=async()=>{try{return(await s.get("/users/me/profile")).data}catch(r){throw console.error("Error fetching user profile:",r),r}}}},r=>{var t=t=>r(r.s=t);r.O(0,[787,685,411,358],()=>t(289)),_N_E=r.O()}]);